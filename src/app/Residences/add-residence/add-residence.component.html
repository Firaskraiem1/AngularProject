<div class="container">
    <br><br>
    <form [formGroup]="addResidence" (ngSubmit)="add()">
        <div class="row mb-3">
            <label for="name" class="col-sm-2 col-col-sm-2 col-form-label">Name: </label>
            <div class="col-sm-10">
                <input type="string" class="form-control" name="name" id="name" formControlName="name" />
                <div *ngIf="name?.touched && name?.invalid" class=" alert text-danger">
                    <span class=" text-bg-danger" *ngIf="name?.errors?.['required']">Required Filed</span>
                    <span *ngIf="name?.errors?.['minlength']">Minimum 3 characters required</span>
                </div>
            </div>
        </div>
        <div class="row mb-3">
            <label for="address" class="col-sm-2 col-col-sm-2 col-form-label">Address: </label>
            <div class="col-sm-10">
                <input type="string" class="form-control" name="address" id="address" formControlName="address" />
                <div *ngIf="address?.touched && address?.invalid" class=" alert text-danger">
                    <span class=" text-bg-danger" *ngIf="address?.errors?.['required']">Required Filed</span>
                </div>
            </div>
        </div>
        <div class="row mb-3">
            <label for="image" class="col-sm-2 col-col-sm-2 col-form-label">Image: </label>
            <div class="col-sm-10">
                <input type="file" class="form-control" name="image" id="image" (change)="onFileSelect($event)" />
                <div *ngIf="imageError" class="alert text-danger">
                    <span class=" text-bg-danger" *ngIf="image?.errors?.['required']"> {{ imageError }}</span>
                </div>

            </div>
        </div>
        <div class="row mb-3">
            <label for="status" class="col-sm-2 col-form-label">Status: </label>
            <div class="col-sm-10">
                <select class="form-select" name="status" id="status" formControlName="status">
                    <option value="">Select status</option>
                    <option *ngFor="let status of statusList " [value]="status">{{status}}
                    </option>
                </select>
                <div *ngIf="status?.touched && status?.invalid" class="alert text-danger">
                    <span class=" text-bg-danger" *ngIf="image?.errors?.['required']">Required Filed</span>
                </div>
            </div>
        </div>
        <div formArrayName="apartments" class="mb-3">
            <div *ngFor="let apartment of apartments.controls; let i = index" [formGroupName]="i" class="row mb-3">

                <label for="apartmentName{{ i }}" class="col-sm-2 col-col-sm-2 col-form-label">Apartment Number:
                </label>
                <div class="col-sm-10">
                    <input type="number" class="form-control" name="apartNum" id="apartNum"
                        formControlName="apartNum" />
                    <div *ngIf="apartment.get('apartNum')?.touched && apartment.get('apartNum')?.invalid" class=" alert text-danger">
                        <span class=" text-bg-danger" *ngIf="apartment.get('apartNum')?.errors?.['required']">Required Filed</span>
                        <span class=" text-bg-danger" *ngIf="apartment.get('apartNum')?.errors?.['pattern']">Only digits!!</span>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="apartmentName{{ i }}" class="col-sm-2 col-form-label">Floor Number: </label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control" name="floorNum" id="floorNum"
                            formControlName="floorNum" />
                        <div *ngIf="apartment.get('floorNum')!.touched && apartment.get('floorNum')!.invalid" class="alert text-danger">
                            <div *ngIf="apartment.get('floorNum')?.touched && apartment.get('floorNum')?.invalid" class=" alert text-danger">
                                <span class=" text-bg-danger" *ngIf="apartment.get('floorNum')?.errors?.['required']">Required
                                    Filed</span>
                                <span class=" text-bg-danger" *ngIf="apartment.get('floorNum')?.errors?.['pattern']">Only digits!!</span>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="row mb-3">
                    <label for="apartmentName{{ i }}" class="col-sm-2 col-form-label">Surface: </label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control" name="surface" id="surface"
                            formControlName="surface" />
                        <div *ngIf="apartment.get('surface')!.touched && apartment.get('surface')!.invalid"
                            class="alert text-danger">
                            Required field
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="apartmentName{{ i }}" class="col-sm-2 col-form-label"> Terrace: </label>
                    <div class="col-sm-10">
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="terrace" formControlName="terrace"
                                id="terrace" value="yes" />
                            <label class="form-check-label" for="terrace">
                                Yes
                            </label>
                        </div>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="terrace" formControlName="terrace"
                                id="terrace" value="no" />
                            <label class="form-check-label" for="terrace">
                                No
                            </label>
                        </div>
                        <div *ngIf="apartment.get('terrace')!.touched && apartment.get('terrace')!.invalid"
                            class="alert text-danger">
                            Required field
                        </div>
                    </div>
                </div>

                <div class="row mb-3">
                    <label for="apartmentName{{ i }}" class="col-sm-2 col-form-label">Surface Terrace: </label>
                    <div class="col-sm-10">
                        <input type="number" class="form-control" name="surfaceTerrace" id="surfaceTerrace"
                            [attr.disabled]="apartment.get('terrace')?.value=='yes' ? null: true"
                            formControlName="surfaceterrace" />
                        <div *ngIf="apartment.get('surfaceterrace')!.touched && apartment.get('surfaceterrace')!.invalid"
                            class=" alert text-danger">
                            Required field
                        </div>
                    </div>
                </div>
                <div class="row mb-3">
                    <label for="apartmentName{{ i }}" class="col-sm-2 col-form-label">Category: </label>
                    <div class="col-sm-10">
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="category" id="category" value="S+1"
                                formControlName="category" />
                            <label class="form-check-label" for="category">
                                S+1
                            </label>
                        </div>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="category" id="category" value="S+2"
                                formControlName="category" />
                            <label class="form-check-label" for="category">
                                S+2
                            </label>
                        </div>
                        <div class="form-check">
                            <input type="radio" class="form-check-input" name="category" id="category" value="S+3"
                                formControlName="category" />
                            <label class="form-check-label" for="category">
                                S+3
                            </label>
                        </div>
                        <div *ngIf="apartment.get('category')!.touched && apartment.get('category')!.invalid"
                            class=" alert text-danger">
                            Required field
                        </div>
                    </div>
                </div>


            </div>
        </div>
        <div class="mb-3">
            <button type="button" class="btn btn-secondary" (click)="addApartment()">Add Apartment</button>
        </div>
        <div class="mb-3">
            <input type="submit" class="btn btn-primary" value="Add" [disabled]="addResidence.invalid" />
        </div>
    </form>
</div>